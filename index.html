<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Principal</title>
	<script
      src="https://www.gstatic.com/firebasejs/7.24.0/firebase-app.js"></script>
    <script
      src="https://www.gstatic.com/firebasejs/7.24.0/firebase-auth.js"></script>
    <script
      src="https://www.gstatic.com/firebasejs/7.24.0/firebase-firestore.js"></script>
    <script
      src="https://www.gstatic.com/firebasejs/7.24.0/firebase-storage.js"></script>
    <script src="js/init.js"></script>
    <script type="module" src="inhtml/BarraNav.js"></script>
    <script type="module" src="inhtml/footer.js"></script>
    <script type="module" src="inhtml/Progreso.js"></script>
    <link rel="stylesheet" type="css/estilos.css">
</head>
<body>
	<nav id="miNav"></nav>
	<header>
		<h1>Mi perfil</h1>
		<button id="terminarSesion" type="button">Cerrar Sesi√≥n</button>
	</header>
	<figure><img id="avatar"  alt="Avatar">	
	</figure>
	<p>
		<label>
			Email
			<output id="email"></output>
		</label>
	</p>
	<p>
		<label>
			Nombre
			<output id="nombre">
				<barra-progreso></barra-progreso>
			</output>
		</label>
	</p>
	<pie></pie>
	<script type="module">
	 import { Fabrica } from "./js/General.js";
	 import { muestraError } from "./lib/util.js";

	 const ControlSesion = Fabrica.instancia.ControlSesion;
	 terminarSesion.addEventListener("click",
	 	() => ControlSesion.terminarSesion());

	 protege();
	 async function protege(){
	 	try{
	 	const usuarioAutorizado = await ControlSesion.protege("");
	 	miNav.protege(usuarioAutorizado.privilegios);
	 	email value = usuarioAutorizado.email;
	 	nombre.value = usuarioAutorizado.nombre;
	 	avatar.src = usuarioAutorizado.urlFoto;
	 	} catch (error){
	 		muestraError(error)
	 	}	
	 }
</script>
</body>
</html>